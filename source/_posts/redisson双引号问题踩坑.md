---
title: redisson双引号问题踩坑
date: 2019-03-30 22:13:34
tags: wrong
---

	今天在使用redisson操作的时候踩了一个小坑，特此记录一下。
	具体业务场景不介绍了，现象就是提供给其他人的接口总是返回空，无法获取到数据，接口内的逻辑非常简单，就是基本的操作缓存和数据库，先查询redis，没有的话再到库中去查，频繁报错后也是心生疑惑，debug后才恍然大悟。
	项目中配置redisson并没有特殊指明codec用哪种类型，默认使用了jackson格式，在存储字符串的时候会多存入两个双引号，导致你后续查询key的时候根本获取不到对应数据，改为StringCodec问题就非常简单的解决啦。
	不过如果是改造旧接口的话一定要注意线上缓存会不会突然失效，再有就是这样一来redis中所有键值对取出来的时候都变成了String，假如原来代码中存在get()方法可能导致报出类型转换异常，我这里的处理方式是暂时写了一个工具类，在老代码get的时候调用对应类型的转换方法，但是如果项目中使用的地方非常多的话，那改起来会非常麻烦，所以建议在项目之初就不要挖这种坑给后人。
